#!/bin/bash
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

VERSION=`$DIR/python3 --version`

#check python version
if [[ $VERSION == *"3.7"* ]]; then
    PYTHON_LIB=libpython3.7m
elif [[ $VERSION == *"3.8"* ]]; then
    PYTHON_LIB=libpython3.8
elif [[ $VERSION == *"3.9"* ]]; then
    PYTHON_LIB=libpython3.9
else
    echo "Unsupported Python version $VERSION"
    exit 1
fi

if [[ $( uname ) == 'Darwin' ]]; then
    export CHAIN_API_LIB=$DIR/../lib/libchain_api.dylib
    export VM_API_LIB=$DIR/../lib/libvm_api.dylib
    LIB_SUFFIX=dylib
else
    export CHAIN_API_LIB=$DIR/../lib/libchain_api.so
    export VM_API_LIB=$DIR/../lib/libvm_api.so
    LIB_SUFFIX=so
fi

export PYTHON_SHARED_LIB_PATH=$DIR/../lib/$PYTHON_LIB.$LIB_SUFFIX

$DIR/uuos $@

